<!-- Page Heading -->
<!--<h1 class="h3 mb-2 text-gray-800">Herramienta de Distribución</h1>-->
<style>
    .input-inline {
        display: flex;
        width: 125px !important;
    }
    .input-inline input {
        margin-right: 1px; /* Ajusta el margen según sea necesario */
        width: 60px;
    }
    .input-inline input:last-child {
        margin-right: 0;
    }
    .modal-backdrop {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.5); /* Color semitransparente */
        z-index: 1040; /* z-index superior al modal */
    }
    .disabled-row {
        background-color: #e0e0e0 !important; /* Fondo más claro */
        color: #606060 !important; /* Texto más claro */
        pointer-events: none; /* Evita que el usuario interactúe con la fila */
        opacity: 0.6; /* Reduce la opacidad para hacer la fila parecer desactivada */
    }
    .disabled-row td {
        pointer-events: none; /* Evita que el usuario interactúe con celdas */
    }
    .danger-row {
        background-color: #FFB2B2 !important; /* Fondo más claro */
    }
    .min-row {
        background-color: #F9FFB2 !important; /* Fondo más claro */
    }
    .legend {
        position: fixed;
        top: 80px;
        right: 25px;
        background: #fff;
        border: 1px solid #ccc;
        padding: 5px;
        font-size: 12px;
        z-index: 1000;
    }
    .legend-item {
        display: flex;
        align-items: center;
        margin-bottom: 2px;
    }
    .color-box {
        width: 10px;
        height: 10px;
        margin-right: 5px;
    }
    .color-red {
        background-color: red;
    }
    .color-green {
        background-color: green;
    }
    .color-blue {
        background-color: blue;
    }
    #chart-container {
        display: flex;
        justify-content: center;
        align-items: center;
    }
    .containertext {
        display: flex;
    }
    .box {
        padding: 1px;
        margin: 1px;
    }
    .modal-dialog {
        display: flex;
        align-items: center;
        justify-content: center;
        min-height: 100vh;
        margin: 0 auto;
    }
</style>
<div class="card">
    <div class="card-body">
        <div class="container">
            <h5>Cargos y Descargos</h5>
            <!-- Primera columna de campos -->
            <div class="row mb-3">
                <div class="col-md-3">
                    <label for="secuencia" class="form-label">Secuencia</label>
                    <input type="number" class="form-control" id="secuencia" placeholder="Secuencia">
                </div>
                <div class="col-md-3">
                    <label for="almacen" class="form-label">Almacén</label>
                    <select class="form-control" id="almacen">
                        <option value=""></option>
                    </select>
                </div>
                <div class="col-md-3">
                    <label for="timovimiento" class="form-label">Ti-Movimiento</label>
                    <select class="form-control" id="timovimiento">
                        <option value=""></option>
                    </select>
                </div>
                <div class="col-md-3" id='divestab' style="display:none;">
                    <label for="establec-o" id='labelestab' class="form-label">Establec O</label>
                    <select class="form-control" id="selectestab">
                        <option value=""></option>
                    </select>
                </div>
            </div>

            <!-- Segunda columna de campos -->
            <div class="row mb-3">
                <div class="col-md-3">
                    <label for="s-orden-c" class="form-label">S-Orden C</label>
                    <input type="number" class="form-control" id="s-orden-c" value='0'>
                </div>
                <div class="col-md-3">
                    <label for="establec-o" id='labelestabfiltro' class="form-label">Establec Filtro</label>
                    <select class="form-control" id="selectestabfiltro" disabled>
                        <option value=""></option>
                    </select>
                </div>
                <div class="col-md-3">
                    <label for="f-movimiento" class="form-label">F-Movimiento</label>
                    <input type="date" class="form-control" id="f-movimiento" placeholder="F-Movimiento" disabled>
                </div>
                <div class="col-md-3">
                    <label for="sectipmovimiento" class="form-label">S-Ti Movimiento</label>
                    <input type="number" class="form-control" id="sectipmovimiento">
                </div>
            </div>

            <!-- Tercera columna de campos -->
            <div class="row mb-3">
                <div class="col-md-3">
                    <label for="s-movim-asoc" class="form-label">S-Movim Asoc</label>
                    <input type="number" class="form-control" id="s-movim-asoc" value='0' disabled>
                </div>
                <div class="col-md-3">
                    <label for="referencia" class="form-label">Referencia</label>
                    <select class="form-control" id="referencia">
                        <option value=""></option>
                    </select>
                </div>
                <div class="col-md-3" id='divserie' style="display:none;">
                    <label for="serie" class="form-label">Serie</label>
                    <select class="form-control" id="serie">
                        <option value=""></option>
                    </select>
                </div>
            </div>
            <hr>
            <!-- Datos Documento -->
            <div class="mt-5">
                <h5>Datos Documento</h5>
                <div class="row mb-3">
                    <div class="col-md-4">
                        <label for="documento" class="form-label">Documento</label>
                        <div class="row">
                            <div class="col">
                                <input type="text" class="form-control" id="documento1" value='00'>
                            </div>
                            <div class="col">
                                <input type="text" class="form-control" id="documento2">
                            </div>
                            <div class="col">
                                <input type="text" class="form-control" id="documento3">
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <label for="proveedor" class="form-label">Proveedor</label>
                        <select class="form-control" id="proveedor">
                            <option value="">NO ESPECIFICA</option>
                        </select>
                    </div>
                    <div class="col-md-4">
                        <label for="f-documento" class="form-label">F-Documento</label>
                        <input type="date" class="form-control" id="f-documento">
                    </div>
                </div>
                <div class="row mb-3">
                    <div class="col-md-3">
                        <label for="tipago" class="form-label">Ti-Pago</label>
                        <select class="form-control" id="tipago">
                            <option value=""></option>
                        </select>
                    </div>
                    <div class="col-md-3">
                        <label for="no-dias" class="form-label">No-Dias</label>
                        <input type="number" class="form-control" id="no-dias" value='0' disabled>
                    </div>
                    <div class="col-md-3">
                        <label for="f-pago" class="form-label">F-Pago</label>
                        <input type="date" class="form-control" id="f-pago" disabled>
                    </div>
                    <div class="col-md-3">
                        <label for="dscto1" class="form-label">Dscto1 (%)</label>
                        <input type="number" class="form-control" id="dscto1" value='0.00' disabled>
                    </div>
                </div>
                <div class="row mb-3">
                    <div class="col-md-3">
                        <label for="dscto2" class="form-label">Dscto2 (%)</label>
                        <input type="number" class="form-control" id="dscto2" value='0.00' disabled>
                    </div>
                    <div class="col-md-3">
                        <label for="moneda" class="form-label">Moneda</label>
                        <select class="form-control" id="moneda">
                            <option value=""></option>
                        </select>
                    </div>
                    <div class="col-md-3">
                        <label for="to-dsto" class="form-label">To-Dsto</label>
                        <input type="number" class="form-control" id="to-dsto" value='0.00' disabled>
                    </div>
                    <div class="col-md-3">
                        <label for="to-afecto" class="form-label">To-Afecto</label>
                        <input type="number" class="form-control" id="to-afecto" value='0.00' disabled>
                    </div>
                </div>
                <div class="row mb-3">
                    <div class="col-md-3">
                        <label for="to-inafecto" class="form-label">To-Inafecto</label>
                        <input type="number" class="form-control" id="to-inafecto" value='0.00' disabled>
                    </div>
                    <div class="col-md-3">
                        <label for="to-impuesto" class="form-label">To-Impuesto</label>
                        <input type="number" class="form-control" id="to-impuesto" value='0.00' disabled>
                    </div>
                    <div class="col-md-3">
                        <label for="total" class="form-label">Total</label>
                        <input type="number" class="form-control" id="total" value='0.00' disabled>
                    </div>
                    <div class="col-md-3">
                        <label for="to-cargos" class="form-label">To-Cargos</label>
                        <input type="number" class="form-control" id="to-cargos" value='0.00' disabled>
                    </div>
                </div>
                <div class="row mb-3">
                    <div class="col-md-6">
                        <label for="observacion" class="form-label">Observación</label>
                        <input type="text" class="form-control" id="observacion" placeholder="Observación">
                    </div>
                    <div class="col-md-6">
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="almacen-transito" disabled>
                            <label class="form-check-label" for="almacen-transito">
                                Trabaja con Almacén Tránsito
                            </label>
                        </div>
                    </div>
                </div>
            </div>
            <hr>
            <div class="mt-5" id='divtransl'>
                <div class="form-row">
                    <div class="form-group col-md-4">
                        <label for="f-traslado">F-Traslado:</label>
                        <input type="date" class="form-control" id="f-traslado" name="f-traslado">
                    </div>
                    <div class="form-group col-md-4">
                        <label for="motivotraslado">Motivo Traslado:</label>
                        <select class="form-control" id="motivotraslado" name="motivo-traslado">
                            <option value=""></option>
                            <!-- Añadir más opciones si es necesario -->
                        </select>
                    </div>
                    <div class="form-group col-md-4">
                        <label for="placa-vehiculo">Placa Vehículo:</label>
                        <input type="text" class="form-control" id="placa-vehiculo">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group col-md-4">
                        <label for="peso-bruto">Peso Bruto:</label>
                        <input type="text" class="form-control" id="peso-bruto" value="0.000">
                    </div>
                    <div class="form-group col-md-4">
                        <label for="undmedida">Und-Medida:</label>
                        <select class="form-control" id="undmedida">
                            <option value=""></option>
                            <!-- Añadir más opciones si es necesario -->
                        </select>
                    </div>
                    <div class="form-group col-md-4">
                        <label for="transportista">Transportista:</label>
                        <select class="form-control" id="transportista">
                            <option value=""></option>
                            <!-- Añadir más opciones si es necesario -->
                        </select>
                    </div>
                </div>
            </div>
            <h5>Productos</h5>
            <table class="table table-bordered">
                <thead class="thead-light">
                    <tr>
                        <th>Secue.</th>
                        <th>Lote</th>
                        <th>Producto</th>
                        <th>Lab.</th>
                        <th>Fec.Venc.</th>
                        <th>Cant.E</th>
                        <th>Cant.F</th>
                        <th>Precio</th>
                        <th>Opcion</th>
                    </tr>
                </thead>
                <tbody>
                </tbody>
            </table>
            <button class="btn btn-primary" id="agregar">
                <i class="fas fa-plus"></i> Agregar
            </button>

        </div>
    </div>

    <div class="modal border" id="modaltablaproductos" style="display:none;position: fixed;width: 100%;height: 100%;">
        <div class="modal-content" style="position: absolute;top: 50%; left: 50%;transform: translate(-50%, -50%);width: 98%;height: 98%;border: 2px solid #333;border-radius: 10px;overflow-y: auto;">
            <div class="modal-header">
                <div id="datosproducto">
                </div>
                <button class="close" type="button" id="cerrarmodal">
                    <span aria-hidden="true">×</span>
                </button>
            </div>
            <div class="modal-body">
                <div id="filtro">
                    <div id="modal-distribucion" class="modal fade modalencima" id="exampleModal" role="dialog" aria-labelledby="exampleModalLabel"
                         aria-hidden="true">
                        <div class="modal-dialog" role="document">
                            <div class="modal-content" style="border: 1px solid #333; border-radius: 10px; box-shadow: 0 16px 24px rgba(0, 0, 0, 0.6);">
                                <div class="modal-header">
                                    <h6 class="modal-title">Parametros de Distribución</h6>
                                    <button class="close" type="button" data-dismiss="modal" aria-label="Close">
                                        <span aria-hidden="true">&times;</span>
                                    </button>
                                </div>
                                <div class="modal-body">
                                    <p>Seleccione la cantidad de dias y la fecha:</p>
                                    <div class="form-group">
                                        <label for="selectStockMinimo">Dias:</label>
                                        <input type="number"class="form-control" id="selectStockMinimo" value=45>
                                    </div>
                                    <div class="form-group">
                                        <label for="inputFecha">Periodo en que ingresó la mercadería:</label>
                                        <div class="form-group form-check">
                                            <input type="checkbox" class="form-check-input" id="checkboxFecha">
                                            <label class="form-check-label" for="checkboxFecha">Ingresados hasta el:</label>
                                        </div>
                                        <input type="date" class="form-control" id="inputFecha">
                                    </div>

                                    <div class="form-group">
                                        <label for="selectFiltro">Filtrar por:</label>
                                        <select class="form-control" id="selectFiltro">
                                            <option value="TODOS">Todos</option>
                                            <option value="SECUENCIA">Por secuencia de ingreso</option>
                                            <option value="TIPO">Por tipo de producto</option>
                                        </select>
                                    </div>

                                    <div class="form-group" id="secuenciaInput" style="display: none;">
                                        <label for="inputSecuencia">Número de secuencia de ingreso:</label>
                                        <input type="number" class="form-control" id="inputSecuencia">
                                    </div>

                                    <div class="form-group" style="overflow-y: auto;display: none;" id="tipoProductoTable">
                                        <table id="tabletipos" class="table table-striped table-bordered table-sm text-dark">
                                            <thead>
                                                <tr>
                                                    <th>Codigo</th>
                                                    <th>Tipo de producto</th>
                                                    <th>Filtro</th>
                                                </tr>
                                            </thead>
                                        </table>
                                    </div>

                                </div>
                                <div class="modal-footer">
                                    <button id="btnAceptar" type="button" class="btn btn-primary">Aceptar</button>
                                    <!-- Puedes agregar más botones aquí -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div id="producto">
                    <div class="row">
                        <div class="col-12">
                            <div class="d-flex flex-wrap justify-content-center justify-content-md-end">
                                <button id="btnNuevaDistribucion" class="btn btn-primary mr-1 mb-1"><i class="fas fa-search-plus"></i> Búsqueda</button>
                            </div>
                        </div>

                    </div>
                    <div class="row">
                        <div class="col">
                            <div class="form-check" id='divsolorojoscentral'>
                                <input class="form-check-input" type="checkbox"  id="solorojoscentral">
                                <label class="form-check-label" for="solorojoscentral">Mostar solo los almacenes desabastecidos</label>
                            </div>
                            <div class="form-check">
                                <input type="checkbox" class="form-check-input" id="automatico" checked>
                                <label class="form-check-label" for="automatico">Llenar distribucion automaticamente</label>
                            </div>  
                        </div>
                    </div>       
                    <div class="row">
                        <div class="col">
                            <div class="table-responsive" style="position: relative; height: 620px;overflow-y: auto">
                                <table id="table-central" class="table table-striped table-bordered text-dark table-sm" style="width:100%;color:black">
                                    <thead style="position: sticky;top: 0;z-index: 1;background-color: #fff;">
                                        <tr>
                                            <th>Tipo </th>
                                            <th>Codigo</th>
                                            <th>Descripcion</th>
                                            <th>Lab.</th>
                                            <th>UnidxFrac.</th>
                                            <th>StockAlm</th>
                                            <th>StockAlmF</th>
                                            <th>Acción</th>
                                        </tr>
                                    </thead>

                                </table>

                                <div id="loadingcentral" style="display:none" >
                                    <center><img src="img/loader.gif" alt="cargando"/><br/>Un momento, por favor...</center>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div id="detalle" style="display:none">
                    <div class="row">
                        <div class="col-auto">
                            <div id="nombre-grafica">Unidades Vendidas</div>
                            <div id="chart-container2">
                                <canvas id="myAreaChart" width="800" height="80"></canvas>
                            </div>
                        </div>
                        <div class="legend" style="align-self: end ">
                            <div class="legend-item">
                                <span class="color-box danger-row"></span> Lote que vence primero(toda la fila: falta poco para vencerse)
                            </div>
                            <div class="legend-item">
                                <span class="color-box min-row"></span>  Lote que vence posteriormente
                            </div>
                        </div>
                    </div>

                    <div class="form-check" id="divsolorojosestab">
                        <input type="checkbox" class="form-check-input" id="solorojos">
                        <label class="form-check-label" for="solorojos">Mostrar establecimientos desabastecidos</label>
                    </div>  
                    <!--<div id="vista-table-establecimientos" style="display: none;">-->
                    <div  class="table-responsive"  style="position: relative; height: 380px;overflow-y: auto">
                        <table id="table-establecimientos" class="table table-bordered text-dark table-sm" style="color:black;" >
                            <thead  style="position: sticky;top: 0;z-index: 1;background-color: #fff;">
                                <tr>
                                    <th>Establecimiento</th>
                                    <th>Lote</th>
                                    <th>Fech. Ven.</th>
                                    <th>Cant.E.</th>
                                    <th>Cant.F.</th>
                                    <th>Stck.E</th>
                                    <th>Stck.F</th>
                                    <th id='stkmin2'>Prom.Ven.</th>
                                    <th>Sugerido</th>
                                    <th>Distribución</th>
                                </tr>
                            </thead>
                            <tfoot  style="position: sticky;bottom:  0;z-index: 1;background-color: #fff;">
                                <tr>
                                    <th>Totales:</th>
                                    <th></th>
                                    <th></th>
                                    <th id="footlotE">0</th>
                                    <th id="footlotF">0</th>
                                    <th></th>
                                    <th></th>
                                    <th></th>
                                    <th></th>
                                    <th  class="containertext"><div id='footcantE' class="box"></div> - <div class="box" id='footcantF'></div></th>
                                </tr>
                            </tfoot>
                        </table>
                        <div id="loadingproductos" style="display:none" >
                            <center><img src="img/loader.gif" alt="cargando"/><br/>Un momento, por favor...</center>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div id="modal-grafica" class="modal fade" id="exampleModal" tabindex="1" role="dialog" aria-labelledby="exampleModalLabel"
         aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content" style="border: 1px solid #333; border-radius: 10px; box-shadow: 0 16px 24px rgba(0, 0, 0, 0.6);">
                <div class="modal-header">
                    <p id="nombre-grafica2">Grafica:</p>
                    <button class="close" type="button" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <div id="chart-container" style='width: 100%; height: 400px;'>
                        <canvas id="myAreaChart2" width="100" height="100"></canvas>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script src="vendor/chart.js/Chart.js" type="text/javascript"></script>
    <script src="js/cargosdescargos.js" type="text/javascript"></script>
</div>